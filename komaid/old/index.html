<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="author" content="Eko Mardiatno" />

  <title>#1911190064 (komaID)</title>
  <link rel="icon" href="../assets/images/bell.png">

  <link rel="stylesheet" href="../assets/css/bootstrap.min.css">
  <link href="../assets/css/roboto-condensed.css" rel="stylesheet">
  <link rel="stylesheet" href="../assets/css/museo.css">
  <link rel="stylesheet" href="../assets/css/animate.min.css">
  <link rel="stylesheet" href="../assets/css/font-awesome.min.css">

  <style>
    html {
      font-size: 15px;
    }

    body {
      font-family: 'Roboto Condensed', sans-serif;
      font-size: 1rem;
      line-height: 1.35;
      color: #333;
      background-color: #f5f5f5;
    }

    .page-wrapper {
      width: 100%;
      overflow-x: hidden;
    }

    hr {
      margin-top: .75rem;
      margin-bottom: .75rem;
    }

    .wrapper {
      width: 460px;
      max-width: 100%;
    }

    .back-top {
      position: fixed;
      bottom: 50px;
      right: 15px;
      width: 40px;
      height: 40px;
      border-radius: 20px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.15rem;
      box-shadow: 5px 5px 15px -5px rgba(0, 0, 0, .35);
      z-index: 9999;
    }

    a:hover,
    a:focus {
      text-decoration: none;
    }

    .shadow {
      box-shadow: 0 13px 15px -10px rgba(0, 0, 0, .2);
    }

    .current {
      position: relative;
      z-index: 1;
      background-color: #ffeaa7;
      box-shadow: 0 15px 20px -10px rgba(253, 203, 110, .8);
    }

    .form-control:focus {
      box-shadow: none;
    }
  </style>

  <script src="../assets/js/jquery.min.js"></script>
  <script src="../assets/js/bootstrap.bundle.min.js">
  </script>
</head>

<body>
  <div class="page-wrapper">
    <div class="container py-3">
      <div class="d-flex flex-row justify-content-center">
        <div class="wrapper">
          <div class="form mb-3">
            <div class="input-group rounded shadow">
              <input type="text" class="form-control bg-light border-light" id="search"
                placeholder="Ketik & tekan Enter untuk mencari">
              <div class="input-group-append">
                <div class="input-group-text text-primary bg-light border-light">
                  <span class="fas fa-search"></span>
                </div>
              </div>
            </div>
          </div>
          <div id="app"></div>
        </div>
      </div>
    </div>
  </div>

  <a style="display:none" class="back-top bg-danger text-white" href="#">
    <span class="fas fa-arrow-up"></span>
  </a>

  <script>
    $('#search').on('change', function () {
      let value = $(this).val().toLowerCase()
      $('#app .card').filter(function () {
        $(this).toggle($(this).html().toLowerCase().indexOf(value) > -1)
      })
    })

    jQuery(document).ready(function () {
      var offset = screen.height / 2,
        duration = 800
      jQuery(window).scroll(function () {
        if (jQuery(this).scrollTop() > offset) {
          jQuery('.back-top').fadeIn(duration)
        } else {
          jQuery('.back-top').fadeOut(duration)
        }
      })

      jQuery('.back-top').click(function (event) {
        event.preventDefault()
        jQuery('html, body').animate({
          scrollTop: 0
        }, duration)
        return false
      })
    })

    $(window).on('load', function () {
      let current = $('.card.current')
      let offsetTop = current.offset().top
      let height = current.height()
      $('html, body').animate({
        scrollTop: offsetTop - height - 30
      }, 1000)
      current.addClass('animated tada slower delay-1s infinite')
    })
  </script>

  <script>
    function Currency(val) {
      val = val.toFixed(0)
      val = val.toString()
      var mod = val.length % 3,
        currency = val.substr(0, mod),
        thousand = val.substr(mod).match(/\d{3}/g),
        separator = ''
      if (thousand) {
        separator = mod ? ',' : ''
        currency += separator + thousand.join(',')
      }
      return 'Rp' + currency
    }

    function mask(val) {
      val = typeof val === 'number' ? val.toString() : val
      val = val.split('.')
      let end = val[1] ? '.' + val[1] : ''
      val = val[0]
      var mod = val.length % 3,
        mask = val.substr(0, mod),
        thousand = val.substr(mod).match(/\d{3}/g),
        separator = ''
      if (thousand) {
        separator = mod ? ',' : ''
        mask += separator + thousand.join(',')
      }
      return mask + end
    }

    function tanggalIndo(date) {
      let tanggal = date.getDate()
      tanggal = tanggal.toString().length < 2 ? `0${tanggal}` : tanggal
      let bulan = date.getMonth()
      let tahun = date.getFullYear()
      let DATE = new Date()
      DATE.setHours(7)
      switch (bulan) {
        case 0:
          bulan = 'Jan'
          break
        case 1:
          bulan = 'Feb'
          break
        case 2:
          bulan = 'Mar'
          break
        case 3:
          bulan = 'Apr'
          break
        case 4:
          bulan = 'Mei'
          break
        case 5:
          bulan = 'Jun'
          break
        case 6:
          bulan = 'Jul'
          break
        case 7:
          bulan = 'Agu'
          break
        case 8:
          bulan = 'Sep'
          break
        case 9:
          bulan = 'Okt'
          break
        case 10:
          bulan = 'Nov'
          break
        case 11:
          bulan = 'Des'
          break
      }
      let diff = Math.round(Math.round((date.getTime() - DATE.getTime()) / (24 * 60 * 60 * 1000)))
      switch (diff) {
        case -1:
          return `Kemarin (${tanggal} ${bulan} ${tahun})`
        case 0:
          return `Hari ini (${tanggal} ${bulan} ${tahun})`
        case 1:
          return `Besok (${tanggal} ${bulan} ${tahun})`
        case 2:
          return `Lusa (${tanggal} ${bulan} ${tahun})`
        case 3:
          return `Tulat (${tanggal} ${bulan} ${tahun})`
        case 4:
          return `Tubin (${tanggal} ${bulan} ${tahun})`
        default:
          return `${tanggal} ${bulan} ${tahun}`

      }

    }

    let modal = 5000000
    let beli = 20000
    let jual = 15000
    let tanggalMulai = new Date('2019-11-20')
    let tanggalBerakhir = new Date('2025-12-31')
    let saldo = parseFloat(((modal - 1000000) / beli).toFixed(3))
    let ripeningArr = []
    let indexMining = []
    let index = 0
    let mining = 0
    let lama = Math.round(Math.round((tanggalBerakhir.getTime() - tanggalMulai.getTime()) / (24 * 60 * 60 * 1000)))
    let tanggalTarikBulanan = new Date('2022-01-01')
    let nominalTarikBulanan = 15000000
    let tanggalTarikTahunan = new Date('2022-12-15')
    let nominalTarikTahunan = 100000000
    let ripeningInterval = 30
    let totalTarik = 0
    let minimalPindahSaldo = 10
    let sisakanMining = 0.05
    let biayaPindahMining = 0.005
    let totalPindah = 0
    let report = []
    let app = $('#app')
    let _withdraw = 0
    let totalTopup = 0
    let _topup = 0
    let biayaTopup = 0
    app.before(`
            <div class="card mb-3 border-0 shadow bg-light">
              <div class="card-body p-3">
                <p class="mb-1">#1911190064 (komaID)</p>
                <h3 class="mb-0"><span class="text-muted small">sejak</span>${tanggalIndo(tanggalMulai)}</h3>
              </div>
            </div>
            `)
    for (let i = 1; i <= lama; i++) {
      let tanggal = new Date(tanggalMulai.getTime() + (i * 24 * 60 * 60 * 1000))

      if (indexMining.indexOf(i) > -1) {
        index = indexMining.indexOf(i)
        mining = mining + ripeningArr[index]
        //report.push(`Hasil mining ${ripeningArr[index]}`)
        report.push({
          tipe: 'MINING',
          edc: ripeningArr[index]
        })
      }

      ripeningArr.push(parseFloat((saldo * (.5 / 100)).toFixed(3)))
      indexMining.push(i + 30)

      if (indexMining.indexOf(i) > -1) {
        index = indexMining.indexOf(i)
        ripeningArr[index] = 0
      }

      if (i === ripeningInterval) {
        report.push({
          tipe: 'TOTAL_RIPENING',
          edc: parseFloat(ripeningArr.reduce((total, num) => {
            return total + num
          }).toFixed(3))
        })
      }

      if (tanggal.getTime() === new Date('2019-12-26').getTime()) {
        minimalPindahSaldo = 1
      }
      if (tanggal.getTime() === new Date('2020-02-17').getTime()) {
        minimalPindahSaldo = 10
      }

      if (tanggal.getTime() !== new Date('2020-02-15').getTime() && tanggal.getTime() !== new Date('2020-04-04')
        .getTime() && tanggal.getTime() !== new Date('2020-05-03').getTime()) {
        if ((mining - sisakanMining - biayaPindahMining) >= minimalPindahSaldo) {
          if (tanggal.getTime() === new Date('2020-01-22').getTime()) {
            biayaPindahMining = 0.055
          }
          let pindahMining = parseFloat((mining - sisakanMining - biayaPindahMining).toFixed(3))
          let totalMining = mining
          if (tanggal.getTime() === new Date('2020-01-11').getTime()) {
            pindahMining = 3.459
            mining = mining - pindahMining - biayaPindahMining
            // mining = mining - (mining - sisakanMining)
          } else {
            mining = mining - (mining - sisakanMining)
          }
          mining = parseFloat(mining.toFixed(3))
          report.push({
            tipe: 'PINDAH_MINING',
            edc: pindahMining,
            totalMining: parseFloat(totalMining.toFixed(3))
          })
          saldo = saldo + pindahMining
          saldo = parseFloat(saldo.toFixed(3))
          totalPindah += pindahMining
        }
      }

      if (tanggal.getTime() === new Date('2019-12-26').getTime()) {
        sisakanMining = 0.005
        report.push({
          tipe: 'PINDAH_MINING',
          edc: parseFloat((mining - sisakanMining - 0.005).toFixed(3)),
          totalMining: parseFloat(mining.toFixed(3))
        })
        saldo = saldo + parseFloat((mining - sisakanMining - 0.005).toFixed(3))
        saldo = parseFloat(saldo.toFixed(3))
        totalPindah += parseFloat((mining - sisakanMining - 0.005).toFixed(3))
        mining = (mining - (mining - sisakanMining)).toFixed(3)
        mining = parseFloat(mining)
        sisakanMining = 0.001

      }

      if (tanggal.getTime() == tanggalTarikBulanan.getTime()) {
        _withdraw += nominalTarikBulanan
        tanggalTarikBulanan = new Date(tanggalTarikBulanan.getFullYear(), tanggalTarikBulanan.getMonth() + 1, 1,
          7)
        if (tanggalTarikBulanan.getDate() === 1 && tanggalTarikBulanan.getMonth() === 0) {
          nominalTarikBulanan = nominalTarikBulanan * 2
        }
      }

      if (tanggal.getTime() == tanggalTarikTahunan.getTime()) {
        _withdraw += nominalTarikTahunan
        tanggalTarikTahunan = new Date(tanggalTarikTahunan.getFullYear() + 1, tanggalTarikTahunan.getMonth(),
          tanggalTarikTahunan.getDate(), 7)
        nominalTarikTahunan = nominalTarikTahunan + 150000000
      }

      if (tanggal.getTime() === new Date('2022-10-10').getTime()) {
        _withdraw += 600000000
      }
      // Mazda CX-5 Elite
      // Aamiin ya Allah

      if (tanggal.getTime() === new Date('2019-11-22').getTime()) {
        _topup += 10000000
      }

      if (tanggal.getTime() === new Date('2019-12-25').getTime()) {
        _topup += 2000000
      } // Mamak

      if (tanggal.getTime() === new Date('2020-01-21').getTime()) {
        _topup += 2000000
        biayaTopup = .4
      } // Bibik

      if (_topup > 0) {
        saldo = saldo + (_topup / beli) - (biayaTopup / 100 * (_topup / beli))
        saldo = parseFloat(saldo.toFixed(3))
        report.push({
          tipe: 'TOP_UP',
          nominal: _topup,
          fee: (biayaTopup / 100 * (_topup / beli))
        })
        totalTopup += _topup
        _topup = 0
      }

      if (_withdraw > 0) {
        let tarik = 0
        if (_withdraw >= 100000000) {
          tarik = 100000000
          _withdraw -= 100000000
        } else {
          tarik = _withdraw
          _withdraw -= _withdraw
        }
        let biaya = parseFloat(((tarik / jual) * (0.3 / 100)).toFixed(3))
        saldo = saldo - parseFloat((tarik / jual).toFixed(3)) - biaya
        report.push({
          tipe: 'WITHDRAW',
          biaya: biaya,
          nominal: tarik
        })
        saldo = parseFloat(saldo.toFixed(3))
        totalTarik += tarik
      }

      if (i === ripeningInterval) {
        totalPindah = parseFloat(totalPindah.toFixed(3))
        if (totalPindah > 0) {
          report.push({
            tipe: 'TOTAL_PINDAH_MINING',
            edc: totalPindah
          })
        }
        totalPindah = 0

        ripeningInterval = ripeningInterval + 30
      }

      if (report.length > 0) {
        let dateNow = new Date()
        dateNow.setHours(7)
        let diff = Math.round(Math.round((tanggal.getTime() - dateNow.getTime()) / (24 * 60 * 60 * 1000)))
        //if(diff >= -1) {
        let html =
          `<div class="card mb-3 border-0 shadow ${diff == 0 ? 'current' : ''}"><div class="card-body p-3">`
        html +=
          `<p class="mb-2">${tanggalIndo(tanggal)} ${i % 30 == 0 ? '<span class="text-muted small">bulan ke-'+(i/30).toFixed(0)+'</span>' : ''}</p>`
        for (let j = 0; j < report.length; j++) {
          switch (report[j].tipe) {
            case 'TOP_UP':
              html += `<div class="text-success py-1 d-flex flex-row justify-content-between">`
              html += `<div class="d-flex"><p class="small text-muted m-0">#Top-Up</p></div>`
              html += `<div class="d-flex"><h6 class="m-0 text-right">${Currency(report[j].nominal)}`
              if (report[j].fee) {
                html +=
                  `<p class="small text-muted m-0">+${mask(parseFloat((report[j].nominal / beli - report[j].fee).toFixed(3)))} EDC</p>`
              } else {
                html +=
                  `<p class="small text-muted m-0">+${mask(parseFloat((report[j].nominal / beli).toFixed(3)))} EDC</p>`
              }
              html += `</h6></div>`
              html += `</div>`
              break
            case 'WITHDRAW':
              html += `<div class="text-danger py-1 d-flex flex-row justify-content-between">`
              html += `<div class="d-flex"><p class="small text-muted m-0">#Withdraw</p></div>`
              html +=
                `<div class="d-flex"><h6 class="m-0 text-right">${Currency(report[j].nominal)}<p class="small text-muted m-0">-${mask(parseFloat((report[j].nominal / jual + report[j].biaya).toFixed(3)))} EDC</p></h6></div>`
              html += `</div>`
              break
            case 'MINING':
              html += `<div class="text-primary py-1 d-flex flex-row justify-content-between">`
              html += `<div class="d-flex"><p class="small text-muted m-0">#Mining</p></div>`
              html +=
                `<div class="d-flex"><h6 class="m-0 text-right">${mask(report[j].edc)} EDC</h6></div>`
              html += `</div>`
              break
            case 'TOTAL_RIPENING':
              html += `<div class="text-primary py-1 d-flex flex-row justify-content-between">`
              html += `<div class="d-flex"><p class="small text-muted m-0">#Total ripening</p></div>`
              html +=
                `<div class="d-flex"><h6 class="m-0 text-right">${mask(report[j].edc)} EDC</h6></div>`
              html += `</div>`
              break
            case 'PINDAH_MINING':
              html += `<div class="text-success py-1 d-flex flex-row justify-content-between">`
              html += `<div class="d-flex"><p class="small text-muted m-0">#Pindah mining</p></div>`
              html +=
                `<div class="d-flex"><h6 class="m-0 text-right">+${mask(report[j].edc)}<span class="small text-muted">/${mask(report[j].totalMining)}</span> EDC</h6></div>`
              html += `</div>`
              break
            case 'TOTAL_PINDAH_MINING':
              html += `<div class="text-primary py-1 d-flex flex-row justify-content-between">`
              html += `<div class="d-flex"><p class="small text-muted m-0">#Total pindah mining</p></div>`
              html +=
                `<div class="d-flex"><h6 class="m-0 text-right">${mask(report[j].edc)} EDC</h6></div>`
              html += `</div>`
              break
            default:
              html += ``
          }
        }
        let uangku = parseFloat((saldo - (modal - 1000000) / beli - (saldo * (0.3 / 100))).toFixed(3)) * jual
        if (uangku > 0) {
          uangku = parseFloat(uangku.toFixed(3))
          uangku = Currency(uangku)
          html += `<div class="text-primary py-1 d-flex flex-row align-items-center justify-content-between">`
          html += `<div class="d-flex"><p class="small text-muted m-0">#Maksimal withdraw</p></div>`
          html += `<div class="d-flex"><h6 class="m-0 text-right">${uangku}</h6></div>`
          html += `</div>`
        }
        html +=
          `<hr class="my-2"><h4 class="m-0 text-right"><span class="small text-muted">saldo</span>${mask(saldo)} EDC</h4>`
        html += `</div></div>`
        app.append(html)
        //}
        report = []
      }
    }

    let html = `<div class="card bg-warning mb-3 border-0 shadow"><div class="card-body p-3">`
    html += `<p class="m-0">#Total deposit</p>`
    html += `<h4 class="m-0">${Currency(totalTopup + modal)}</h4>`
    html += '</div></div>'
    html += `<div class="card bg-primary text-white mb-3 border-0 shadow"><div class="card-body p-3">`
    html += `<p class="m-0 text-light">#Total withdraw</p>`
    html += `<h4 class="m-0">${Currency(totalTarik)}</h4>`
    html += '</div></div>'
    app.after(html)
  </script>
</body>

</html>